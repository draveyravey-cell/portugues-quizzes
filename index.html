<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Exerc√≠cios de Portugu√™s</title>

  <meta name="color-scheme" content="light dark" />
  <meta id="meta-theme-color" name="theme-color" content="#0e0f11" />

  <!-- Config do app (preencha com as chaves do seu projeto) -->
  <script>
    window.APP_CONFIG = {
      authProvider: "supabase",
      supabaseUrl: "https://gyyoustzoasdytxflwoc.supabase.co",
      supabaseAnonKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd5eW91c3R6b2FzZHl0eGZsd29jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3OTkyNTQsImV4cCI6MjA3ODM3NTI1NH0.SvkebZ9pxqYhzzY9Zeu0EOGzA6-vFXb0uQ6DbpmRi4Y"
    };
  </script>
  <!-- SDK Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <!-- Evita flash de tema -->
  <script>
    (function () {
      try {
        const saved = localStorage.getItem("theme");
        const prefersDark = window.matchMedia && window.matchMedia("(prefers-color-scheme: dark)").matches;
        const theme = saved || (prefersDark ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", theme);
      } catch (e) { }
    })();
  </script>

  <link rel="stylesheet" href="assets/css/styles.css" />
</head>

<body>
  <!-- SVG sprite (√≠cones) -->
  <svg xmlns="http://www.w3.org/2000/svg" style="display:none">
    <symbol id="i-search" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M10 2a8 8 0 1 1 5.293 13.707l4.5 4.5-1.414 1.414-4.5-4.5A8 8 0 0 1 10 2zm0 2a6 6 0 1 0 0 12A6 6 0 0 0 10 4z" />
    </symbol>
    <symbol id="i-filter" viewBox="0 0 24 24">
      <path fill="currentColor" d="M3 5h18v2l-7 7v5l-4 2v-7L3 7z" />
    </symbol>
    <symbol id="i-sync" viewBox="0 0 24 24">
      <path fill="currentColor" d="M12 6V3l4 4-4 4V8a4 4 0 1 0 3.465 6H17a6 6 0 1 1-5-8z" />
    </symbol>
    <symbol id="i-user" viewBox="0 0 24 24">
      <path fill="currentColor" d="M12 12a5 5 0 1 0-5-5 5 5 0 0 0 5 5Zm0 2c-5 0-9 2.5-9 5v3h18v-3c0-2.5-4-5-9-5Z" />
    </symbol>
    <symbol id="i-logout" viewBox="0 0 24 24">
      <path fill="currentColor" d="M10 17v2H4V5h6v2H6v10h4Zm9-5-4-4v3h-5v2h5v3Z" />
    </symbol>
    <symbol id="i-help" viewBox="0 0 24 24">
      <path fill="currentColor"
        d="M12 2a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Zm1 17h-2v-2h2Zm2.07-7.75-.9.92A2.49 2.49 0 0 0 13 14h-2v-.5a4 4 0 0 1 1.17-2.83l1.24-1.26a1.5 1.5 0 1 0-2.54-1.06H9a3.5 3.5 0 1 1 6.07 2.39Z" />
    </symbol>
    <symbol id="i-info" viewBox="0 0 24 24">
      <path fill="currentColor" d="M11 17h2v-6h-2Zm0-8h2V7h-2Zm1-7a10 10 0 1 0 10 10A10.011 10.011 0 0 0 12 2Z" />
    </symbol>
    <symbol id="i-download" viewBox="0 0 24 24">
      <path fill="currentColor" d="M5 20h14v-2H5Zm7-16-4 4h3v6h2V8h3Z" />
    </symbol>
    <symbol id="i-upload" viewBox="0 0 24 24">
      <path fill="currentColor" d="M5 20h14v-2H5Zm7-16-4 4h3v6h2V8h3Z" transform="rotate(180 12 12)" />
    </symbol>
    <symbol id="i-time" viewBox="0 0 24 24">
      <path fill="currentColor" d="M12 1a11 11 0 1 0 11 11A11.012 11.012 0 0 0 12 1Zm1 12h5v-2h-4V6h-2v7Z" />
    </symbol>
  </svg>

  <!-- Skip link -->
  <a class="skip-link" href="#inicio">Pular para o conte√∫do</a>

  <header class="topbar">
    <div class="container topbar__inner">
      <div class="brand">Portugu√™s Pr√°tico</div>

      <nav class="nav" aria-label="Navega√ß√£o principal">
        <a href="#inicio">In√≠cio</a>
        <a href="#exercicios">Exerc√≠cios</a>
        <a href="#historico">Hist√≥rico</a>
        <a href="#editor">Editor</a>
        <a href="#conta">Conta</a>
        <a href="#sobre">Sobre</a>
      </nav>

      <div class="actions">
        <span id="status-badge" class="status-badge" title="Status">
          <span class="dot" aria-hidden="true"></span>
          <span id="status-badge-text">Local</span>
        </span>
        <button id="theme-toggle" class="icon-btn" type="button" aria-label="Alternar tema" title="Alternar tema">
          <span class="theme-icon" aria-hidden="true">üåô</span>
        </button>
        <button id="account-btn" class="icon-btn" type="button" aria-label="Conta" title="Minha conta">
          <svg class="icon" aria-hidden="true">
            <use href="#i-user" />
          </svg>
        </button>
      </div>
    </div>
  </header>

  <!-- Fundo decorativo -->
  <div class="bg-decor" aria-hidden="true">
    <svg viewBox="0 0 1440 360" preserveAspectRatio="none" class="bg-decor__svg">
      <defs>
        <linearGradient id="g1" x1="0" y1="0" x2="1" y2="1">
          <stop offset="0%" stop-color="rgba(106,166,255,.35)" />
          <stop offset="100%" stop-color="rgba(255,224,138,.12)" />
        </linearGradient>
        <radialGradient id="g2" cx="75%" cy="20%" r="60%">
          <stop offset="0%" stop-color="rgba(133,193,255,.5)" />
          <stop offset="100%" stop-color="rgba(133,193,255,0)" />
        </radialGradient>
      </defs>
      <rect width="1440" height="360" fill="url(#g2)" />
      <path d="M0,200 C240,280 480,120 720,200 C960,280 1200,160 1440,220 L1440,360 L0,360 Z" fill="url(#g1)" />
    </svg>
  </div>

  <!-- Timer do simulado -->
  <div id="exam-timer" class="exam-timer hidden" aria-live="polite">
    <svg class="icon" aria-hidden="true">
      <use href="#i-time" />
    </svg>
    <span id="exam-timer-text">00:00</span>
    <button id="exam-timer-toggle" class="exam-timer__btn" type="button" title="Pausar/Retomar">
      Pausar
    </button>
  </div>

  <main class="container">
    <section class="hero" id="inicio">
      <h1>Exerc√≠cios de Portugu√™s</h1>
      <p>Pratique ortografia, acentua√ß√£o, crase, concord√¢ncia e muito mais. üöÄ</p>
    </section>

    <section class="controls" id="exercicios">
      <!-- Ajuda: Exerc√≠cios -->
      <details class="help" id="help-exercicios">
        <summary><svg class="icon">
            <use href="#i-help" />
          </svg> Como usar os exerc√≠cios</summary>
        <ul>
          <li>Use a busca para filtrar por enunciado/tema/categoria.</li>
          <li>Filtros refinam por categoria e dificuldade; ‚ÄúLimpar‚Äù reseta.</li>
          <li>Clique em ‚ÄúResponder‚Äù para abrir o player; use Anterior/Pr√≥xima.</li>
          <li>Pagina√ß√£o controla quantos itens por p√°gina e navega entre p√°ginas.</li>
        </ul>
      </details>

      <div class="controls__row">
        <label for="busca" class="sr-only">Buscar exerc√≠cios</label>
        <input id="busca" type="search" placeholder="Buscar por enunciado, tema ou categoria..."
          data-tip="Digite termos como 'crase', '√† tarde'..." />
        <span class="hint"><svg class="icon" aria-hidden="true">
            <use href="#i-search" />
          </svg> Dica: experimente ‚Äúcrase‚Äù, ‚Äúacentua√ß√£o‚Äù, ‚Äúpor que‚Äù...</span>
      </div>

      <div class="controls__row controls__row--filters">
        <div class="views">
          <button id="view-all" class="chip is-active" type="button" data-tip="Mostrar todos">Todos</button>
          <button id="view-fav" class="chip" type="button" data-tip="Mostrar favoritos">Favoritos</button>
          <button id="view-err" class="chip" type="button" data-tip="Mostrar caderno de erros">Erros</button>
        </div>
        <div class="filters">
          <label for="f-categoria" class="sr-only">Filtrar por categoria</label>
          <select id="f-categoria" aria-label="Filtrar por categoria"
            data-tip="Filtre por categoria (ex.: Crase, Ortografia...)">
            <option value="all">Todas as categorias</option>
          </select>
          <!-- Simulado -->
          <div class="controls__row controls__row--sim">
            <div class="sim">
              <label class="sr-only" for="sim-qtd">Quantidade de quest√µes</label>
              <select id="sim-qtd" aria-label="Quantidade de quest√µes">
                <option value="5">5 quest√µes</option>
                <option value="10" selected>10 quest√µes</option>
                <option value="20">20 quest√µes</option>
                <option value="30">30 quest√µes</option>
                <option value="50">50 quest√µes</option>
              </select>

              <label class="sr-only" for="sim-dur">Dura√ß√£o</label>
              <select id="sim-dur" aria-label="Dura√ß√£o do simulado">
                <option value="5">5 min</option>
                <option value="10" selected>10 min</option>
                <option value="20">20 min</option>
                <option value="30">30 min</option>
              </select>

              <button id="sim-start" class="button primary" type="button" title="Iniciar simulado">
                <svg class="icon" aria-hidden="true">
                  <use href="#i-time" />
                </svg> Iniciar simulado
              </button>
              <span class="hint">Sem feedback durante o simulado; resultado ao final.</span>
            </div>
          </div>

          <label for="f-dificuldade" class="sr-only">Filtrar por dificuldade</label>
          <select id="f-dificuldade" aria-label="Filtrar por dificuldade"
            data-tip="Filtre por dificuldade (f√°cil, m√©dio, dif√≠cil)">
            <option value="all">Todas as dificuldades</option>
          </select>

          <button id="f-clear" class="button" type="button" title="Limpar filtros e busca"
            data-tip="Limpar busca e filtros">
            <svg class="icon" aria-hidden="true">
              <use href="#i-info" />
            </svg> Limpar
          </button>
        </div>
      </div>
    </section>

    <section class="lista">
      <h2>Lista de quest√µes</h2>
      <div id="msg" class="msg" aria-live="polite"></div>

      <!-- Pagina√ß√£o (topo) -->
      <div id="pager-top" class="pager" aria-label="Pagina√ß√£o de exerc√≠cios"></div>

      <div id="lista-questoes" class="grid"></div>

      <!-- Pagina√ß√£o (rodap√©) -->
      <div id="pager-bottom" class="pager" aria-label="Pagina√ß√£o de exerc√≠cios"></div>
    </section>

    <section id="historico" class="history">
      <h2>Hist√≥rico de estudos</h2>
      <!-- Ajuda: Hist√≥rico -->
      <details class="help" id="help-historico">
        <summary><svg class="icon">
            <use href="#i-help" />
          </svg> Como usar o hist√≥rico</summary>
        <ul>
          <li>Veja m√©tricas gerais e as tentativas recentes.</li>
          <li>Exporte JSON/CSV ou importe um hist√≥rico salvo.</li>
          <li>Se estiver logado, use ‚ÄúSincronizar agora‚Äù na aba Conta.</li>
        </ul>
      </details>
      <p class="hint">Seus dados ficam salvos apenas no seu navegador (local).</p>

      <div id="hist-stats" class="stats-grid"></div>

      <div class="history__actions">
        <input id="hist-file" type="file" accept="application/json" hidden />
        <button id="hist-export" class="button" type="button" title="Exportar hist√≥rico em JSON">
          <svg class="icon" aria-hidden="true">
            <use href="#i-download" />
          </svg> Exportar JSON
        </button>
        <button id="hist-export-csv" class="button" type="button" title="Exportar tentativas em CSV">
          <svg class="icon" aria-hidden="true">
            <use href="#i-download" />
          </svg> Exportar CSV
        </button>
        <button id="hist-import" class="button" type="button" title="Importar hist√≥rico de um arquivo JSON">
          <svg class="icon" aria-hidden="true">
            <use href="#i-upload" />
          </svg> Importar JSON
        </button>
        <button id="hist-clear" class="button" type="button" title="Remove todas as sess√µes e tentativas">
          <svg class="icon" aria-hidden="true">
            <use href="#i-info" />
          </svg> Limpar hist√≥rico
        </button>
      </div>

      <div class="history__list">
        <h3>Tentativas recentes</h3>
        <div id="hist-attempts"></div>
      </div>

      <div class="history__sessions">
        <h3>Sess√µes</h3>
        <div id="hist-sessions"></div>
      </div>

      <div class="history__perq">
        <h3>Estat√≠sticas por quest√£o</h3>
        <div id="hist-perq"></div>
      </div>
    </section>

    <section id="editor" class="editor">
      <h2>Editor de exerc√≠cios (JSON)</h2>
      <!-- Ajuda: Editor -->
      <details class="help" id="help-editor">
        <summary><svg class="icon">
            <use href="#i-help" />
          </svg> Como usar o editor</summary>
        <ul>
          <li>Carregue do servidor ou de um arquivo local.</li>
          <li>Valide/formate e aplique override para pr√©-visualizar no site.</li>
          <li>Desativar override volta ao JSON do servidor; Limpar apaga o override salvo.</li>
        </ul>
      </details>
      <p class="hint">
        Edite e valide o JSON dos exerc√≠cios. Voc√™ pode ‚ÄúAplicar (override)‚Äù para pr√©-visualizar no site sem alterar o
        arquivo no servidor.
      </p>

      <div class="editor__actions">
        <input id="editor-file" type="file" accept="application/json" hidden />
        <button id="ed-load-server" class="button" type="button" title="Carregar data/exercicios.json do servidor">
          <svg class="icon" aria-hidden="true">
            <use href="#i-download" />
          </svg> Carregar do servidor
        </button>
        <button id="ed-load-file" class="button" type="button" title="Carregar de um arquivo local">
          <svg class="icon" aria-hidden="true">
            <use href="#i-upload" />
          </svg> Carregar arquivo‚Ä¶
        </button>
        <button id="ed-validate" class="button" type="button" title="Validar e formatar JSON">
          <svg class="icon" aria-hidden="true">
            <use href="#i-info" />
          </svg> Validar/Formatar
        </button>
        <span class="editor__spacer"></span>
        <button id="ed-apply" class="button primary" type="button" title="Aplicar override local (preview)">
          <svg class="icon" aria-hidden="true">
            <use href="#i-sync" />
          </svg> Aplicar (override)
        </button>
        <button id="ed-disable" class="button" type="button" title="Desativar override">
          <svg class="icon" aria-hidden="true">
            <use href="#i-logout" />
          </svg> Desativar override
        </button>
        <button id="ed-clear" class="button" type="button" title="Limpar override do navegador">
          <svg class="icon" aria-hidden="true">
            <use href="#i-info" />
          </svg> Limpar override
        </button>
        <button id="ed-download" class="button" type="button" title="Baixar JSON atual">
          <svg class="icon" aria-hidden="true">
            <use href="#i-download" />
          </svg> Baixar JSON
        </button>
      </div>

      <div class="editor__status" id="ed-status" aria-live="polite"></div>

      <div class="editor__wrap">
        <label for="editor-json" class="sr-only">Conte√∫do do JSON</label>
        <textarea id="editor-json" spellcheck="false" aria-label="Conte√∫do do JSON dos exerc√≠cios"></textarea>
      </div>

      <div id="editor-validation" class="validation"></div>

      <!-- Auth (modal) -->
      <div id="auth-overlay" class="overlay hidden" aria-hidden="true">
        <section class="modal" role="dialog" aria-modal="true" aria-labelledby="auth-title"
          aria-describedby="auth-desc">
          <header class="modal__header">
            <h2 id="auth-title">Entrar</h2>
            <button id="auth-close" class="icon-btn" type="button" aria-label="Fechar">‚úï</button>
          </header>
          <div class="modal__body">
            <p id="auth-desc" class="sr-only">Entre com e-mail e senha ou crie uma conta.</p>
            <div class="form">
              <div class="form-row">
                <label class="form-label" for="auth-email">E-mail</label>
                <input id="auth-email" class="form-input" type="email" autocomplete="email"
                  placeholder="voce@exemplo.com" />
              </div>
              <div class="form-row">
                <label class="form-label" for="auth-pass">Senha</label>
                <input id="auth-pass" class="form-input" type="password" autocomplete="current-password"
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              </div>
              <div class="form-row form-actions">
                <button id="auth-login" class="button primary" type="button">Entrar</button>
                <button id="auth-signup" class="button" type="button">Criar conta</button>
              </div>
              <div id="auth-msg" class="msg" aria-live="polite"></div>
            </div>
          </div>
          <footer class="modal__footer">
            <div class="pager__size">
              <span class="hint">Se preferir, continue como visitante. Seus dados ficam no navegador.</span>
            </div>
            <div class="modal__actions">
              <button id="auth-logout" class="button" type="button" hidden>
                <svg class="icon" aria-hidden="true">
                  <use href="#i-logout" />
                </svg> Sair
              </button>
              <button id="auth-sync" class="button" type="button" hidden>
                <svg class="icon" aria-hidden="true">
                  <use href="#i-sync" />
                </svg> Sincronizar agora
              </button>
            </div>
          </footer>
        </section>
      </div>
    </section>

    <section id="conta" class="account">
      <h2>Minha conta</h2>
      <!-- Ajuda: Conta -->
      <details class="help" id="help-conta">
        <summary><svg class="icon">
            <use href="#i-help" />
          </svg> Como usar a conta</summary>
        <ul>
          <li>Entre/crie conta no bot√£o ‚ÄúAbrir painel de conta‚Äù.</li>
          <li>Ative a sincroniza√ß√£o autom√°tica e ajuste o intervalo.</li>
          <li>‚ÄúSincronizar agora‚Äù for√ßa o push/pull dos dados.</li>
        </ul>
      </details>
      <p class="hint">Gerencie seu login, sincroniza√ß√£o e veja seu tempo online.</p>

      <div class="account__grid">
        <div class="account-card">
          <h3>Status da conta</h3>
          <ul class="account-list">
            <li><span class="label">Estado:</span> <span id="acc-status">Visitante</span></li>
            <li><span class="label">E-mail:</span> <span id="acc-email">‚Äî</span></li>
            <li><span class="label">User ID:</span> <span id="acc-uid">‚Äî</span></li>
            <li><span class="label">Conectividade:</span> <span id="acc-online">‚Äî</span></li>
          </ul>
          <div class="account-actions">
            <button id="acc-open-modal" class="button" type="button" title="Abrir painel de conta">
              <svg class="icon" aria-hidden="true">
                <use href="#i-user" />
              </svg> Abrir painel de conta
            </button>
            <button id="acc-logout" class="button" type="button" title="Sair da conta">
              <svg class="icon" aria-hidden="true">
                <use href="#i-logout" />
              </svg> Sair
            </button>
          </div>
        </div>

        <div class="account-card">
          <h3>Sincroniza√ß√£o</h3>
          <div class="switch-row">
            <label class="switch" title="Ativar/desativar sincroniza√ß√£o autom√°tica">
              <input id="acc-auto-sync" type="checkbox" />
              <span class="switch-slider" aria-hidden="true"></span>
            </label>
            <span>Sincroniza√ß√£o autom√°tica</span>
            <label class="sr-only" for="acc-interval">Intervalo</label>
            <select id="acc-interval" title="Intervalo de auto sync">
              <option value="60000">1 min</option>
              <option value="300000">5 min</option>
              <option value="900000">15 min</option>
            </select>
          </div>

          <ul class="account-list">
            <li><span class="label">Locais (tentativas):</span> <span id="acc-local-attempts">0</span></li>
            <li><span class="label">Nuvem (√∫ltimo pull):</span> <span id="acc-remote-attempts">0</span></li>
            <li><span class="label">√öltimo pull:</span> <span id="acc-last-pull">‚Äî</span></li>
            <li><span class="label">√öltimo push:</span> <span id="acc-last-push">‚Äî</span></li>
          </ul>

          <div class="account-actions">
            <button id="acc-sync-now" class="button primary" type="button" title="Sincronizar agora">
              <svg class="icon" aria-hidden="true">
                <use href="#i-sync" />
              </svg> Sincronizar agora
            </button>
          </div>
          <div id="acc-sync-msg" class="msg" aria-live="polite"></div>
        </div>

        <div class="account-card">
          <h3>Tempo online</h3>
          <ul class="account-list">
            <li><span class="label">Sess√£o atual:</span> <span id="acc-time-session">00:00:00</span></li>
            <li><span class="label">Total neste usu√°rio:</span> <span id="acc-time-total">00:00:00</span></li>
          </ul>
          <div class="account-actions">
            <button id="acc-time-reset" class="button" type="button" title="Zerar total">
              <svg class="icon" aria-hidden="true">
                <use href="#i-time" />
              </svg> Zerar total
            </button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer" id="sobre">
    <div class="container">
      <p>Feito para estudar Portugu√™s. Interface e c√≥digo em evolu√ß√£o.</p>
    </div>
  </footer>

  <!-- Player (modal) -->
  <div id="player-overlay" class="overlay hidden" aria-hidden="true">
    <section class="modal" role="dialog" aria-modal="true" aria-labelledby="player-title"
      aria-describedby="player-desc">
      <header class="modal__header">
        <h2 id="player-title">Responder exerc√≠cio</h2>
        <button id="player-close" class="icon-btn" type="button" aria-label="Fechar">‚úï</button>
      </header>

      <div class="modal__body" id="player-content">
        <p id="player-desc" class="sr-only">Selecione ou digite sua resposta e clique em Verificar.</p>
      </div>

      <footer class="modal__footer">
        <div class="feedback" id="player-feedback" aria-live="polite"></div>
        <div class="modal__actions">
          <button id="player-prev" class="button" type="button">Anterior</button>
          <button id="player-next" class="button" type="button">Pr√≥xima</button>
          <button id="player-finish" class="button" type="button">Finalizar</button>
          <button id="player-verify" class="button primary" type="button" disabled>Verificar</button>
        </div>
      </footer>
    </section>
  </div>

  <!-- Ordem dos scripts -->
  <script src="assets/js/storage.js" defer></script>
  <script src="assets/js/a11y.js" defer></script>
  <script src="assets/js/player.js" defer></script>
  <script src="assets/js/exam.js" defer></script>
  <script src="assets/js/history.js" defer></script>
  <script src="assets/js/editor.js" defer></script>
  <script src="assets/js/auth.js" defer></script>
  <script src="assets/js/sync.js" defer></script>
  <script src="assets/js/account.js" defer></script>
  <script src="assets/js/ui.js" defer></script>
  <script src="assets/js/app.js" defer></script>
</body>

</html>