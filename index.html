<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <title>Exerc√≠cios de Portugu√™s</title>

  <meta name="color-scheme" content="light dark" />
  <meta id="meta-theme-color" name="theme-color" content="#0e0f11" />
  <!-- Config do app (preencha com as chaves do seu projeto) -->
  <script>
    window.APP_CONFIG = {
      authProvider: "supabase",
      supabaseUrl: "https://gyyoustzoasdytxflwoc.supabase.co",
      supabaseAnonKey: "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imd5eW91c3R6b2FzZHl0eGZsd29jIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjI3OTkyNTQsImV4cCI6MjA3ODM3NTI1NH0.SvkebZ9pxqYhzzY9Zeu0EOGzA6-vFXb0uQ6DbpmRi4Y"
    };
  </script>
  <!-- SDK Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Evita flash de tema -->
  <script>
    (function () {
      try {
        const saved = localStorage.getItem("theme");
        const prefersDark =
          window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: dark)").matches;
        const theme = saved || (prefersDark ? "dark" : "light");
        document.documentElement.setAttribute("data-theme", theme);
      } catch (e) { }
    })();
  </script>

  <link rel="stylesheet" href="assets/css/styles.css" />
</head>

<body>
  <!-- Skip link -->
  <a class="skip-link" href="#inicio">Pular para o conte√∫do</a>

  <header class="topbar">
    <div class="container topbar__inner">
      <div class="brand">Portugu√™s Pr√°tico</div>

      <nav class="nav" aria-label="Navega√ß√£o principal">
        <a href="#inicio">In√≠cio</a>
        <a href="#exercicios">Exerc√≠cios</a>
        <a href="#historico">Hist√≥rico</a>
        <a href="#editor">Editor</a>
        <a href="#conta">Conta</a>
        <a href="#sobre">Sobre</a>
      </nav>

      <div class="actions">
        <button id="theme-toggle" class="icon-btn" type="button" aria-label="Alternar tema">
          <span class="theme-icon" aria-hidden="true">üåô</span>
        </button>
        <button id="account-btn" class="icon-btn" type="button" aria-label="Conta">üë§</button>
      </div>
    </div>
  </header>

  <main class="container">
    <section class="hero" id="inicio">
      <h1>Exerc√≠cios de Portugu√™s</h1>
      <p>Pratique ortografia, acentua√ß√£o, crase, concord√¢ncia e muito mais. üöÄ</p>
    </section>

    <section class="controls" id="exercicios">
      <div class="controls__row">
        <label for="busca" class="sr-only">Buscar exerc√≠cios</label>
        <input id="busca" type="search" placeholder="Buscar por enunciado, tema ou categoria..." />
        <span class="hint">Dica: experimente ‚Äúcrase‚Äù, ‚Äúacentua√ß√£o‚Äù, ‚Äúpor que‚Äù...</span>
      </div>

      <div class="controls__row controls__row--filters">
        <div class="filters">
          <label for="f-categoria" class="sr-only">Filtrar por categoria</label>
          <select id="f-categoria" aria-label="Filtrar por categoria">
            <option value="all">Todas as categorias</option>
          </select>

          <label for="f-dificuldade" class="sr-only">Filtrar por dificuldade</label>
          <select id="f-dificuldade" aria-label="Filtrar por dificuldade">
            <option value="all">Todas as dificuldades</option>
          </select>

          <button id="f-clear" class="button" type="button" title="Limpar filtros e busca">Limpar</button>
        </div>
      </div>
    </section>

    <section class="lista">
      <h2>Lista de quest√µes</h2>
      <div id="msg" class="msg" aria-live="polite"></div>

      <!-- Pagina√ß√£o (topo) -->
      <div id="pager-top" class="pager" aria-label="Pagina√ß√£o de exerc√≠cios"></div>

      <div id="lista-questoes" class="grid"></div>

      <!-- Pagina√ß√£o (rodap√©) -->
      <div id="pager-bottom" class="pager" aria-label="Pagina√ß√£o de exerc√≠cios"></div>
    </section>

    <section id="historico" class="history">
      <h2>Hist√≥rico de estudos</h2>
      <p class="hint">Seus dados ficam salvos apenas no seu navegador (local).</p>

      <div id="hist-stats" class="stats-grid"></div>

      <div class="history__actions">
        <input id="hist-file" type="file" accept="application/json" hidden />
        <button id="hist-export" class="button">Exportar JSON</button>
        <button id="hist-export-csv" class="button">Exportar CSV</button>
        <button id="hist-import" class="button">Importar JSON</button>
        <button id="hist-clear" class="button" title="Remove todas as sess√µes e tentativas">Limpar hist√≥rico</button>
      </div>

      <div class="history__list">
        <h3>Tentativas recentes</h3>
        <div id="hist-attempts"></div>
      </div>

      <div class="history__sessions">
        <h3>Sess√µes</h3>
        <div id="hist-sessions"></div>
      </div>

      <div class="history__perq">
        <h3>Estat√≠sticas por quest√£o</h3>
        <div id="hist-perq"></div>
      </div>
    </section>

    <section id="editor" class="editor">
      <h2>Editor de exerc√≠cios (JSON)</h2>
      <p class="hint">
        Edite e valide o JSON dos exerc√≠cios. Voc√™ pode ‚ÄúAplicar (override)‚Äù para pr√©-visualizar no site sem alterar o
        arquivo no servidor.
      </p>

      <div class="editor__actions">
        <input id="editor-file" type="file" accept="application/json" hidden />
        <button id="ed-load-server" class="button" type="button"
          title="Carregar data/exercicios.json do servidor">Carregar do servidor</button>
        <button id="ed-load-file" class="button" type="button" title="Carregar de um arquivo local">Carregar
          arquivo‚Ä¶</button>
        <button id="ed-validate" class="button" type="button" title="Validar e formatar JSON">Validar/Formatar</button>
        <span class="editor__spacer"></span>
        <button id="ed-apply" class="button primary" type="button" title="Aplicar override local (preview)">Aplicar
          (override)</button>
        <button id="ed-disable" class="button" type="button" title="Desativar override">Desativar override</button>
        <button id="ed-clear" class="button" type="button" title="Limpar override do navegador">Limpar override</button>
        <button id="ed-download" class="button" type="button" title="Baixar JSON atual">Baixar JSON</button>
      </div>

      <div class="editor__status" id="ed-status" aria-live="polite"></div>

      <div class="editor__wrap">
        <label for="editor-json" class="sr-only">Conte√∫do do JSON</label>
        <textarea id="editor-json" spellcheck="false" aria-label="Conte√∫do do JSON dos exerc√≠cios"></textarea>
      </div>

      <div id="editor-validation" class="validation"></div>
      <!-- Auth (modal) -->
      <div id="auth-overlay" class="overlay hidden" aria-hidden="true">
        <section class="modal" role="dialog" aria-modal="true" aria-labelledby="auth-title"
          aria-describedby="auth-desc">
          <header class="modal__header">
            <h2 id="auth-title">Entrar</h2>
            <button id="auth-close" class="icon-btn" type="button" aria-label="Fechar">‚úï</button>
          </header>
          <div class="modal__body">
            <p id="auth-desc" class="sr-only">Entre com e-mail e senha ou crie uma conta.</p>
            <div class="form">
              <div class="form-row">
                <label class="form-label" for="auth-email">E-mail</label>
                <input id="auth-email" class="form-input" type="email" autocomplete="email"
                  placeholder="voce@exemplo.com" />
              </div>
              <div class="form-row">
                <label class="form-label" for="auth-pass">Senha</label>
                <input id="auth-pass" class="form-input" type="password" autocomplete="current-password"
                  placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
              </div>
              <div class="form-row form-actions">
                <button id="auth-login" class="button primary" type="button">Entrar</button>
                <button id="auth-signup" class="button" type="button">Criar conta</button>
              </div>
              <div id="auth-msg" class="msg" aria-live="polite"></div>
            </div>
          </div>
          <footer class="modal__footer">
            <div class="pager__size">
              <span class="hint">Se preferir, continue como visitante. Seus dados ficam no navegador.</span>
            </div>
            <div class="modal__actions">
              <button id="auth-logout" class="button" type="button" hidden>Sair</button>
              <button id="auth-sync" class="button" type="button" hidden>Sincronizar agora</button>
            </div>
          </footer>
        </section>
      </div>
    </section>
    <section id="conta" class="account">
      <h2>Minha conta</h2>
      <p class="hint">Gerencie seu login, sincroniza√ß√£o e veja seu tempo online.</p>

      <div class="account__grid">
        <div class="account-card">
          <h3>Status da conta</h3>
          <ul class="account-list">
            <li><span class="label">Estado:</span> <span id="acc-status">Visitante</span></li>
            <li><span class="label">E-mail:</span> <span id="acc-email">‚Äî</span></li>
            <li><span class="label">User ID:</span> <span id="acc-uid">‚Äî</span></li>
            <li><span class="label">Conectividade:</span> <span id="acc-online">‚Äî</span></li>
          </ul>
          <div class="account-actions">
            <button id="acc-open-modal" class="button" type="button">Abrir painel de conta</button>
            <button id="acc-logout" class="button" type="button">Sair</button>
          </div>
        </div>

        <div class="account-card">
          <h3>Sincroniza√ß√£o</h3>
          <div class="switch-row">
            <label class="switch">
              <input id="acc-auto-sync" type="checkbox" />
              <span class="switch-slider" aria-hidden="true"></span>
            </label>
            <span>Sincroniza√ß√£o autom√°tica</span>
            <label class="sr-only" for="acc-interval">Intervalo</label>
            <select id="acc-interval">
              <option value="60000">1 min</option>
              <option value="300000">5 min</option>
              <option value="900000">15 min</option>
            </select>
          </div>

          <ul class="account-list">
            <li><span class="label">Locais (tentativas):</span> <span id="acc-local-attempts">0</span></li>
            <li><span class="label">Nuvem (√∫ltimo pull):</span> <span id="acc-remote-attempts">0</span></li>
            <li><span class="label">√öltimo pull:</span> <span id="acc-last-pull">‚Äî</span></li>
            <li><span class="label">√öltimo push:</span> <span id="acc-last-push">‚Äî</span></li>
          </ul>

          <div class="account-actions">
            <button id="acc-sync-now" class="button primary" type="button">Sincronizar agora</button>
          </div>
          <div id="acc-sync-msg" class="msg" aria-live="polite"></div>
        </div>

        <div class="account-card">
          <h3>Tempo online</h3>
          <ul class="account-list">
            <li><span class="label">Sess√£o atual:</span> <span id="acc-time-session">00:00:00</span></li>
            <li><span class="label">Total neste usu√°rio:</span> <span id="acc-time-total">00:00:00</span></li>
          </ul>
          <div class="account-actions">
            <button id="acc-time-reset" class="button" type="button">Zerar total</button>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="footer" id="sobre">
    <div class="container">
      <p>Feito para estudar Portugu√™s. Interface e c√≥digo em evolu√ß√£o.</p>
    </div>
  </footer>

  <!-- Player (modal) -->
  <div id="player-overlay" class="overlay hidden" aria-hidden="true">
    <section class="modal" role="dialog" aria-modal="true" aria-labelledby="player-title"
      aria-describedby="player-desc">
      <header class="modal__header">
        <h2 id="player-title">Responder exerc√≠cio</h2>
        <button id="player-close" class="icon-btn" type="button" aria-label="Fechar">‚úï</button>
      </header>

      <div class="modal__body" id="player-content">
        <p id="player-desc" class="sr-only">Selecione ou digite sua resposta e clique em Verificar.</p>
      </div>

      <footer class="modal__footer">
        <div class="feedback" id="player-feedback" aria-live="polite"></div>
        <div class="modal__actions">
          <button id="player-prev" class="button" type="button">Anterior</button>
          <button id="player-next" class="button" type="button">Pr√≥xima</button>
          <button id="player-finish" class="button" type="button">Finalizar</button>
          <button id="player-verify" class="button primary" type="button" disabled>Verificar</button>
        </div>
      </footer>
    </section>
  </div>

  <!-- Ordem dos scripts: Store -> A11y -> Player -> History -> Editor -> App -->
  <script src="assets/js/storage.js" defer></script>
  <script src="assets/js/a11y.js" defer></script>
  <script src="assets/js/player.js" defer></script>
  <script src="assets/js/history.js" defer></script>
  <script src="assets/js/editor.js" defer></script>
  <script src="assets/js/auth.js" defer></script>
  <script src="assets/js/sync.js" defer></script>
  <script src="assets/js/account.js" defer></script>
  <script src="assets/js/app.js" defer></script>
</body>

</html>